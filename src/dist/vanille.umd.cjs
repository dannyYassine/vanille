(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o.vanille={}))})(this,function(o){"use strict";var F=Object.defineProperty;var U=(o,l,u)=>l in o?F(o,l,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[l]=u;var f=(o,l,u)=>(U(o,typeof l!="symbol"?l+"":l,u),u);function l(t=8){let s="";const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=e.length;let n=0;for(;n<t;)s+=e.charAt(Math.floor(Math.random()*i)),n+=1;return`v${s}`}function u(t){return t.split(/(?=[A-Z])/).join("-").toLowerCase()}function g(...t){return[...t]}window.h=g;function m(t,s){const e=t.$scopedId??l(),i=t[0],n=t[1],r=(()=>(delete t[0],delete t[1],[...t].filter(p=>!!p)))(),h=i.name?customElements.get(`v-${u(i.name)}`):null,a=h?new h:s.createElement(i);return a.props={},n&&Object.entries(n).forEach(([p,$])=>{if(p.startsWith("on")&&$ instanceof Function){if(p in a)a[p.toLowerCase()]=$;else{const I=p.substring(2);a.addEventListener(I,$)}return}a.props[R(p)]=$;try{a.setAttribute(p,$)}catch{}}),a.$scopedId=e,a.setAttribute(a.$scopedId,""),r.length&&r.forEach(p=>{if(["string","number"].includes(typeof p)||(p.$scopedId=a.$scopedId,"nodeName"in p||p instanceof HTMLElement))return a.append(p);a.appendChild(m(p,s))}),a}function R(t){return t.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(s,e){return e===0?s.toLowerCase():s.toUpperCase()}).replace("-","")}function E(){return t=>{t.prototype.renderTemplate=function(){var n,r,h;const s=(n=this.render)==null?void 0:n.call(this),e=document.createElement("style");let i=((r=this.styles)==null?void 0:r.call(this))??"";if(i!==""&&(i=i.trim().replaceAll(/(\S+)(h*.*\{)/gm,`$1[${this.$scopedId}]$2 `)),e.textContent=`${((h=this.globalStylesheet)==null?void 0:h.call(this))??""}${i}`,this.shadowRoot?this.shadowRoot.appendChild(e):this.appendChild(e),s){s.$scopedId=this.$scopedId;const a=m(s,window.document);this.shadowRoot?this.shadowRoot.appendChild(a):this.appendChild(a)}}}}function c(t){const s=w(t)?B([]):{};return C(s),y(s,t),L(s)}function y(t,s){Object.entries(s).forEach(([e,i])=>{if(i&&d(i)&&!("$$listeners"in i))t[e]=c(i);else if(w(i)){const n=i;if(n.length){const r=n[0];if(d(r)&&!("$$listeners"in r)){const h=c(n.map(a=>c(a)));t[e]=h}else!d(r)&&!w(r)&&(t[e]=c(i))}else{const r=[];C(r),b(r),t[e]=r}}else t[e]=i})}function L(t){return b(t),new Proxy(t,{get:(s,e)=>s[e],set:(s,e,i)=>{const n=s[e];return!i.$$listeners&&d(i)&&(i=c(i),P(s[e],i)),s[e]=i,s.$$listeners[e]&&s.$$listeners[e].forEach(r=>{r(i,n,s)}),!0}})}function b(t){Object.defineProperty(t,"$on",{enumerable:!1,configurable:!1,writable:!1,value(s,e){this.$$listeners[s]||(this.$$listeners[s]=[]),this.$$listeners[s].push(e)}})}function P(t,s){d(t)&&(Object.entries(t.$$listeners).forEach(([e,i])=>{s.$$listeners[e]||(s.$$listeners[e]=[]),s.$$listeners[e]=[...i]}),Object.entries(t).forEach(([e])=>{t.$$listeners[e]&&t[e]!==s[e]&&t.$$listeners[e].forEach(i=>{i(s[e],t[e],s)}),P(t[e],s[e])}))}function d(t){return typeof t=="object"&&!Array.isArray(t)}function w(t){return typeof t=="object"&&Array.isArray(t)}function C(t){Object.defineProperty(t,"$$listeners",{enumerable:!1,configurable:!1,writable:!1,value:{}})}function B(t){return t.push=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.push.forEach(n=>{n(arguments,this,this)}),i})(t.push),t.pop=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.pop.forEach(n=>{n(i,this,this)}),i})(t.pop),t.shift=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.shift.forEach(n=>{n(i,this,this)}),i})(t.shift),t.unshift=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.unshift.forEach(n=>{n(arguments,this,this)}),i})(t.unshift),t.splice=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.splice.forEach(n=>{n(i,this,this)}),i})(t.splice),t.sort=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.sort.forEach(n=>{n(i,this,this)}),i})(t.sort),t.reverse=(s=>function(){var i=s.apply(this,arguments);return this.$$listeners.reverse.forEach(n=>{n(i,this,this)}),i})(t.reverse),t}function _(){return t=>{t.prototype.buildProps=function(){this.props=c(this.props)}}}function O(){return t=>{t.prototype.buildState=function(){var s;this.data&&(this.state=c((s=this.data)==null?void 0:s.call(this)))}}}function v(t){return s=>{const e=t??u(s.name);customElements.get(`v-${e}`)||customElements.define(`v-${e}`,s)}}function S(){return t=>{t.prototype.emit=function(s,e){setTimeout(()=>{let i={bubbles:!0};e&&(i={...i},typeof e=="object"?i.detail={...e}:i.detail=e),this.dispatchEvent(new CustomEvent(s,i))},0)}}}var T=Object.defineProperty,D=Object.getOwnPropertyDescriptor,V=(t,s,e,i)=>{for(var n=i>1?void 0:i?D(s,e):s,r=t.length-1,h;r>=0;r--)(h=t[r])&&(n=(i?h(s,e,n):h(n))||n);return i&&n&&T(s,e,n),n};o.BaseView=class extends HTMLElement{constructor(e={}){super();f(this,"refs");f(this,"$scopedId");e!=null&&e.noShadow||this.attachShadow({mode:"open"}),this.$scopedId=l(),this.props={},this.state={},this.refs=new Proxy({},{get:(i,n)=>this.shadowRoot.querySelector(`[${this.$scopedId}][ref=${n}]`)})}setBindings(){}connectedCallback(){this.buildProps(),this.buildState(),this.renderTemplate(),this.setBindings()}removeAllChildren(){const e=this.shadowRoot?this.shadowRoot:this;for(;e.firstChild;)e.removeChild(e.lastChild)}update(){this.removeAllChildren(),this.renderTemplate()}},o.BaseView=V([E(),_(),O(),S()],o.BaseView);var W=Object.defineProperty,M=Object.getOwnPropertyDescriptor,A=(t,s,e,i)=>{for(var n=i>1?void 0:i?M(s,e):s,r=t.length-1,h;r>=0;r--)(h=t[r])&&(n=(i?h(s,e,n):h(n))||n);return i&&n&&W(s,e,n),n};history.pushState=(t=>function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),e})(history.pushState),history.replaceState=(t=>function(){var e=t.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),e})(history.replaceState),window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))}),window.$location=window.location,o.Route=class extends o.BaseView{constructor(){super();f(this,"props",{});f(this,"matchesRoute",!1);f(this,"location");this.location=window.$location}setBindings(){window.addEventListener("locationchange",()=>{this.checkPath()}),this.checkPath()}checkPath(){this.location.pathname===this.props.path||this.matchesPattern()?this.matchesRoute||(this.matchesRoute=!0,this.update()):this.matchesRoute&&(this.matchesRoute=!1,this.update())}matchesPattern(){if(!this.props.startWith&&!this.props.path)return!1;const e=this.location.pathname.split("/").filter(h=>h!=="");let i=this.props.startWith?this.props.startWith.split("/"):this.props.path.split("/");if(i=i.filter(h=>h!==""),this.props.path&&e.length!==i.length)return!1;if(this.props.path)return i.filter((h,a)=>h.startsWith(":")?!0:h===e[a]).length===e.length;const n=i.filter(h=>(h.startsWith(":"),!0));let r=0;for(;r<n.length;){if(n[r].startsWith(":")){r++;continue}if(n[r]!==e[r])return!1;r++}return!0}render(){return this.matchesRoute?["slot",{ref:"slot"}]:""}},o.Route=A([v()],o.Route);var H=Object.defineProperty,J=Object.getOwnPropertyDescriptor,N=(t,s,e,i)=>{for(var n=i>1?void 0:i?J(s,e):s,r=t.length-1,h;r>=0;r--)(h=t[r])&&(n=(i?h(s,e,n):h(n))||n);return i&&n&&H(s,e,n),n};o.If=class extends o.BaseView{constructor(){super({noShadow:!0});f(this,"props")}setBindings(){this.props.$on("value",()=>{this.update()})}render(){return this.props.value?["slot",{ref:"slot"}]:""}},o.If=N([v()],o.If);var Z=Object.defineProperty,q=Object.getOwnPropertyDescriptor,z=(t,s,e,i)=>{for(var n=i>1?void 0:i?q(s,e):s,r=t.length-1,h;r>=0;r--)(h=t[r])&&(n=(i?h(s,e,n):h(n))||n);return i&&n&&Z(s,e,n),n};o.List=class extends o.BaseView{constructor(){super({noShadow:!0});f(this,"props");this.style.display="contents"}setBindings(){this.props.$on("value",()=>{this.update()}),this.props.value.$on("push",()=>{this.update()}),this.props.value.$on("pop",()=>{this.update()}),this.props.value.$on("shift",()=>{this.update()}),this.props.value.$on("unshift",()=>{this.update()}),this.props.value.$on("splice",()=>{this.update()}),this.props.value.$on("sort",()=>{this.update()}),this.props.value.$on("reverse",()=>{this.update()})}render(){this.props.value.map(i=>this.props.item(i)).map(i=>this.appendChild(m(i,window.document)))}},o.List=z([v()],o.List),o.define=v,o.h=g,o.hasEmit=S,o.hasJsxTemplate=E,o.hasObservableProps=_,o.hasObservableState=O,o.observable=c,o.render=m,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
